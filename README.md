# AIPlus
Макросы для ускорения и упрощения работы в САПР Autodesc Inventor

**# Описание**

Макросы предназначены для выполнения заранее определённой последовательности действий с высокой скоростью вместо пользователя.
На данный момент реализованы следующие макросы:

**M_Prop**
Макрос заполняет и создаёт дополнительные "свойства Inventor" с заранее вычисленными или вносимыми вручную данными. Например, автоматически определяет обозначение и наименование детали/сборки по имени файла, и т.д. Без выполнения данного макроса не будут работать большинство остальных макросов.

**BOM_Export**
Макрос создаёт спецификацию из модели/чертежа сборки в формате Excel и экспортирует её в формат PDF. В процессе выполнения макроса компоненты сборки проходят многоуровневую сортировку для получения спецификации согласно ЕСКД (на сколько это необходимо и возможно)

**Documents_to_Production** (на данный момент самый сырой макрос. Применение не рекомендуется)
Макрос выполняет полную проверку КД на предмет отсутствия чертежа, отсутствие спецификации, отсутствия развёртки листовой детали, отсутствие файлов КД для производства, несоответствие номеров изменений , и т.д. Так же возможно последующее копирование всех требуемых файлов в производственную директорию.

**Save_as_PDF_and_DWG**
Макрос сохраняет чертежи в форматах PDF и DWG в отдельных папках.

**Save_CAD_models**
Макрос сохраняет модели деталей/сборок в форматах CAD (STEP, IGES, PDF 3D, и т.д.) в отдельне папки для деталей и сборок.

**Save_Flat_Pattern_As_DXF**
Макрос сохраняет контуры развёртки листовой детали в формате DXF в отдельной папке.

**Drw_First_Save**
Макрос выполняет "правильное" сохранение чертежа. Применяется для первичного сохранения файла чертежа с "правильным" именем файла и в нужную папку.

**Revision_Update**
Макрос вносит/обновляет номер исполнения в основной надписи чертежа.

**# Требования организации проектирования для корректной работы макросов**

**1. Требования к именам файлов**
Имена файлов моделей деталей/сборок, а так же их чертежей должны иметь следующий вид: ОБОЗНАЧЕНИЕ<разделитель>НАИМЕНОВАНИЕ<расширение файла>
Разделитель можно задать в настройках.
Если выбранный разделитель не начинается с символа пробела, то имена файлов моделей прочих и стандартных изделий, материалов и т.д. (без обозначения) рекомендуется приводить к следующему виду: <разделитель>НАИМЕНОВАНИЕ<расширение>
Имена файлов проектов Inventor должны иметь следующий вид: НОМЕР_ПРОЕКТА<разделитель>ЛЮБОЕ_ОПИСАНИЕ_ПРОЕКТА .ipj

**2. Требования к расположению файлов в директории проекта**
Файл проекта должен располагаться в корне директории проекта.
Файлы моделей деталей/сборок и их чертежи могут размещаться в любой папке внутри директории проекта, а так же в корне директории проекта.
Файлы спецификации в формате Excel должны размещаться в той же папке, что и файл модели сборки. Допускается помещать спецификацию в отдельную папку.
Файлы чертежей с спецификаций в форматах PDF и DWG должны размещаться в отдельных папках, расположенных в той же папке, что и сам чертёж/спецификация.
Файлы контуров листовых деталей в формате DXF должны размещаться в отдельной папке, расположенной в той же папке, что и сама модель листовой летали.
Файлы моделей в форматах CAD должны размещаться в отдельных папках, расположенных в той же папке, что и исходная модель.

**3. Требования к чертежу**
Для корректного заполнения всех полей чертежа настоятельно рекомендуется использование шаблона чертежа из репозитория.

**# Способы добавления макросов в Inventor**

Для добавления макросов в Inventor необходимо перенести все файлы (не папки!) из репозитория в директорию проекта VBA по умолчанию. Узнать место расположения этой директории можно в настройках Inventor:

![Пункт меню Файл](https://github.com/GOSTmen/AIPlus/assets/24702466/11ff5ca4-2ccc-49a8-afc5-ce4239b394d8)

![Меню Параметры](https://github.com/GOSTmen/AIPlus/assets/24702466/7a54f994-5270-46a1-aee6-e6c884fb2e35)

![Вкладка Файлы](https://github.com/GOSTmen/AIPlus/assets/24702466/e3b3452d-9d1e-4954-80dd-f6215fe6c783)

![Путь расположения файла проекта VBA по умолчанию](https://github.com/GOSTmen/AIPlus/assets/24702466/8f0d9a3e-bc36-4ea0-95d3-e57b192ae9f1)

По умолчанию это C:\Users\Public\Documents\Autodesk\Inventor 2018\Macros\Default.ivb
Если в сообщении релиза не указаны особые действия для обновления, то необходимо перенести файл "Default.ivb" из репозитория в папку проекта VBA по умолчанию. Старый файл допускается удалить.
